<div class="d-flex flex-column horizontal-expand mb-3">
  <div class="container-fluid d-flex justify-content-center bg-primary m-1">
    <h3 class="py-2">Server Config</h3>
  </div>
  <div class="d-flex flex-column horizontal-expand justify-content-between">
    <!-- Server Hostname -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Server Name</div>
      <div class="p-2 col">
        <input id="server_hostname_input" type="text" class="form-control" placeholder="<%= @config['server_hostname'] %>">
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_hostname');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_hostname', $('#server_hostname_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Server Password -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Server Password</div>
      <div class="p-2 col-4">
        <input id="server_password_input" type="text" class="form-control blur" placeholder="<%= @config['server_password'] %>">
      </div>
      <div class="p-2 col-2">
        <button id="server_password_input_revealer" type="button" class="btn btn-success horizontal-expand mr-4" onclick="revealHide('#server_password_input', '#server_password_input_revealer');">Reveal</button>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_password');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_password', $('#server_password_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Game Port -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Game Port</div>
      <div class="p-2 col">
        <input id="server_game_port_input" type="text" class="form-control" placeholder="<%= @config['server_game_port'] %>">
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_game_port');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_game_port', $('#server_game_port_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Query Port -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Query Port</div>
      <div class="p-2 col">
        <input id="server_query_port_input" type="text" class="form-control" placeholder="<%= @config['server_query_port'] %>">
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_query_port');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_query_port', $('#server_query_port_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- RCON Port -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">RCON Port</div>
      <div class="p-2 col">
        <input id="server_rcon_port_input" type="text" class="form-control" placeholder="<%= @config['server_rcon_port'] %>">
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_rcon_port');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_rcon_port', $('#server_rcon_port_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- RCON Password -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">RCON Password</div>
      <div class="p-2 col-4">
        <input id="server_rcon_password_input" type="text" class="form-control blur" placeholder="<%= @config['server_rcon_password'] %>">
      </div>
      <div class="p-2 col-2">
        <button id="server_rcon_password_input_revealer" type="button" class="btn btn-success horizontal-expand mr-4" onclick="revealHide('#server_rcon_password_input', '#server_rcon_password_input_revealer');">Reveal</button>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_rcon_password');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_rcon_password', $('#server_rcon_password_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- RCON Enabled -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">RCON Enabled</div>
      <div class="p-2 col-2">
        <div class="custom-control custom-switch p-2 ml-5">
          <input type="checkbox" class="custom-control-input" id="server_rcon_enabled_input"<%=' checked' if @config['server_rcon_enabled'].to_s.casecmp('True').zero? %>>
          <label class="custom-control-label" for="server_rcon_enabled_input">Enable RCON</label>
        </div>
      </div>
      <div class="p-2 col-2">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="setServerConfig('server_rcon_enabled', !$('#server_rcon_enabled_input')[0].checked); toggleChecked('#server_rcon_enabled_input');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_rcon_enabled', $('#server_rcon_enabled_input')[0].checked);">Save</button>
        </div>
      </div>
      <div class="p-2 col-2">
        <div class="custom-control custom-switch p-2 ml-5">
          <input type="checkbox" class="custom-control-input" id="server_rcon_allow_console_commands_input"<%=' checked' if @config['server_rcon_allow_console_commands'].to_s.casecmp('True').zero? %>>
          <label class="custom-control-label" for="server_rcon_allow_console_commands_input">Allow Console Commands</label>
        </div>
      </div>
      <div class="p-2 col-2">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="setServerConfig('server_rcon_allow_console_commands', !$('#server_rcon_allow_console_commands_input')[0].checked); toggleChecked('#server_rcon_allow_console_commands_input');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_rcon_allow_console_commands', $('#server_rcon_allow_console_commands_input')[0].checked);">Save</button>
        </div>
      </div>
      <div class="col">
      </div>
    </div>

    <!-- Game Server Login Token (GSLT) -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-3">Game Server Login Token (GSLT)</div>
      <div class="p-2 col-3">
        <input id="server_gslt_input" type="text" class="form-control blur" placeholder="<%= @config['server_gslt'] %>">
      </div>
      <div class="p-2 col-2">
        <button id="server_gslt_input_revealer" type="button" class="btn btn-success horizontal-expand mr-4" onclick="revealHide('#server_gslt_input', '#server_gslt_input_revealer');">Reveal</button>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_gslt');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_gslt', $('#server_gslt_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Cheats -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-3">Cheats (disabled if GSLT set)</div>
      <div class="p-2 col-4 justify-content-end">
          <div class="custom-control custom-switch p-2 ml-5">
            <input type="checkbox" class="custom-control-input" id="server_cheats_input" checked>
            <label class="custom-control-label" for="server_cheats_input">Enable Cheats</label>
          </div>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="setServerConfig('server_cheats', !$('#server_cheats_input')[0].checked); toggleChecked('#server_cheats_input');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_cheats', $('#server_cheats_input')[0].checked);">Save</button>
        </div>
      </div>
    </div>

    <!-- Game Mode -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Game Mode</div>
      <div class="p-2 col">
        <input id="server_game_mode_input" type="text" class="form-control" placeholder="<%= @config['server_game_mode'] %>">
        <ul class="nav nav-pills">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle btn-sm btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="true">Game Modes</a>
            <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 38px, 0px);">
              <% GAME_MODES.sort.each do |mode| %>
              <a class="dropdown-item" onclick="$(`#server_game_mode_input`).val('<%= mode %>')"><%= mode %></a>
              <% end %>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" onclick="$(`#server_game_mode_input`).val('Random')">Random</a>
            </div>
          </li>
        </ul>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_game_mode');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_game_mode', $('#server_game_mode_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Scenario Mode -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Scenario Mode</div>
      <div class="p-2 col">
        <input id="server_scenario_mode_input" type="text" class="form-control" placeholder="<%= @config['server_scenario_mode'] %>">
        <ul class="nav nav-pills">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle btn-sm btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="true">Scenario Mode</a>
            <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 38px, 0px);">
              <% SCENARIO_MODES.sort.each do |mode| %>
              <a class="dropdown-item" onclick="$(`#server_scenario_mode_input`).val('<%= mode %>')"><%= mode %></a>
              <% end %>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" onclick="$(`#server_scenario_mode_input`).val('Random')">Random</a>
            </div>
          </li>
        </ul>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_scenario_mode');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_scenario_mode', $('#server_scenario_mode_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Ruleset -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Ruleset</div>
      <div class="p-2 col">
        <input id="server_rule_set_input" type="text" class="form-control" placeholder="<%= @config['server_rule_set'] %>">
        <ul class="nav nav-pills">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle btn-sm btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="true">Rulesets</a>
            <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 38px, 0px);">
              <% RULE_SETS.sort.each do |rule_set| %>
              <a class="dropdown-item" onclick="$(`#server_rule_set_input`).val('<%= rule_set %>')"><%= rule_set %></a>
              <% end %>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" onclick="$(`#server_rule_set_input`).val('None')">None</a>
            </div>
          </li>
        </ul>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_rule_set');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_rule_set', $('#server_rule_set_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Default Map -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Default Map</div>
      <div class="p-2 col">
        <input id="server_default_map_input" type="text" class="form-control" placeholder="<%= @config['server_default_map'] %>">
        <ul class="nav nav-pills">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle btn-sm btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="true">Maps</a>
            <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 38px, 0px);">
              <% MAPMAP.values.sort.each do |map| %>
              <a class="dropdown-item" onclick="$(`#server_default_map_input`).val('<%= MAPMAP_INVERTED[map] %>')"><%= map %></a>
              <% end %>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" onclick="$(`#server_default_map_input`).val('Random')">Random</a>
            </div>
          </li>
        </ul>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_default_map');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_default_map', $('#server_default_map_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Default Side -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Default Side</div>
      <div class="p-2 col">
        <input id="server_default_side_input" type="text" class="form-control" placeholder="<%= @config['server_default_side'] %>">
        <ul class="nav nav-pills">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle btn-sm btn-primary" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="true">Sides</a>
            <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 38px, 0px);">
              <% SIDES.sort.each do |side| %>
              <a class="dropdown-item" onclick="$(`#server_default_side_input`).val('<%= side %>')"><%= side %></a>
              <% end %>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" onclick="$(`#server_default_side_input`).val('Random')">Random</a>
            </div>
          </li>
        </ul>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_default_side');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_default_side', $('#server_default_side_input').val());">Save</button>
        </div>
      </div>
    </div>

    <!-- Max Players -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-2">Max Players</div>
      <div class="p-2 col-1">Visible:</div>
      <div class="p-2 col-1">
        <input id="server_max_players_input" type="text" class="form-control" placeholder="<%= @config['server_max_players'] %>">
      </div>
      <div class="p-2 col-2">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_max_players');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_max_players', $('#server_max_players_input').val());">Save</button>
        </div>
      </div>
      <div class="p-2 col-1">Actual:</div>
      <div class="p-2 col-1">
        <input id="server_max_players_override_input" type="text" class="form-control" placeholder="<%= @config['server_max_players_override'] %>">
      </div>
      <div class="p-2 col-2">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="undoServerConfig('server_max_players_override');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_max_players_override', $('#server_max_players_override_input').val());">Save</button>
        </div>
      </div>
      <div class="col">
      </div>
    </div>

    <!-- Automatic Updates -->
    <div class="d-flex justify-content-between horizontal-expand bg-light m-1">
      <div class="p-2 col-3">Automatic Updates</div>
      <div class="p-2 col-4 justify-content-end">
        <div class="custom-control custom-switch p-2 ml-5">
          <input type="checkbox" class="custom-control-input" id="server_automatic_updates_enabled_input"<%=' checked' if @config['server_automatic_updates_enabled'].to_s.casecmp('True').zero? %>>
          <label class="custom-control-label" for="server_automatic_updates_enabled_input">Enable Updates</label>
        </div>
      </div>
      <div class="p-2 col-4">
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-secondary m-1" onclick="setServerConfig('server_automatic_updates_enabled', !$('#server_automatic_updates_enabled_input')[0].checked); toggleChecked('#server_automatic_updates_enabled_input');">Undo</button>
          <button type="button" class="btn btn-info m-1 ml-4" onclick="setServerConfig('server_automatic_updates_enabled', $('#server_automatic_updates_enabled_input')[0].checked);">Save</button>
        </div>
      </div>
    </div>

    <!-- Config files -->
    <div class="d-flex flex-column justify-content-start horizontal-expand m-1 bg-light">
      <div class="d-flex justify-content-between horizontal-expand">
        <div class="ml-4 p-2 col-2 horizontal-expand">Config Files</div>
        <ul class="nav nav-tabs">
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#game-ini-tab">Game.ini</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#engine-ini-tab">Engine.ini</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#admins-txt-tab">Admins.txt</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#mapcycle-txt-tab">MapCycle.txt</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#bans-json-tab">Bans.json</a>
          </li>
        </ul>
      </div>
      <div class="d-flex justify-content-between horizontal-expand align-items-start">
        <div id="config-files-tab-content" class="tab-content col-11 blur">
          <div class="tab-pane fade horizontal-expand active show" id="game-ini-tab">
            <textarea id="game-ini" class="m-2 config-file" file="Game.ini"><%= File.read(CONFIG_FILES[:game_ini][:local]) %></textarea>
          </div>
          <div class="tab-pane fade horizontal-expand" id="engine-ini-tab">
            <textarea id="engine-ini" class="m-2 config-file" file="Engine.ini"><%= File.read(CONFIG_FILES[:engine_ini][:local]) %></textarea>
          </div>
          <div class="tab-pane fade horizontal-expand" id="admins-txt-tab">
            <textarea id="admins-txt" class="m-2 config-file" file="Admins.txt"><%= File.read(CONFIG_FILES[:admins_txt][:local]) %></textarea>
          </div>
          <div class="tab-pane fade horizontal-expand" id="mapcycle-txt-tab">
            <textarea id="mapcycle-txt" class="m-2 config-file" file="MapCycle.txt"><%= File.read(CONFIG_FILES[:mapcycle_txt][:local]) %></textarea>
          </div>
          <div class="tab-pane fade horizontal-expand" id="bans-json-tab">
            <textarea id="bans-json" class="m-2 config-file" file="Bans.json"><%= File.read(CONFIG_FILES[:bans_json][:local]) %></textarea>
          </div>
        </div>
        <div class="d-flex flex-column p-2 col-1 ml-1 justify-content-end">
          <button id="config_file_input_revealer" type="button" class="btn btn-success horizontal-expand mr-4 m-1" onclick="revealHide('#config-files-tab-content', '#config_file_input_revealer');">Reveal</button>
          <button type="button" class="btn btn-info horizontal-expand mr-4 m-1" onclick="writeConfigFile();">Save</button>
        </div>
      </div>
    </div>

  </div>
</div>
